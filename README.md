# DatabaseAnalyser

Кодировка: UTF-8
Формат файлов: JSON
Конфигурационный файл бд: dbprops.properties
Используемая по стандарту субд: postgreSQL

Приложения для получения и ввыода данных из бд по входному json файлу. Результат записывается в выходной json файл.

Критерии поиска берутся из файла input.json
Режим работы задаётся в аргументах командной строки. 
Текущие режимы: 
*search - поиск и выдача имен и фамилий пользователей по определенным критериям.
*stat - вывод статистики за определенный период без учета выходных.

Критерии search поиска:
*Поиск всех пользователей по фамилии.
*Поиск покупателей, купивших товар productName не менее minTimes раз.
*Поиск покупателей, у которых общая стоимость всех покупок попадает в указанный интервал minExpenses - maxExpenses
*Поиск покупателей, купивших меньше всего товаров. Вовзвращается не более badCustomers покупателей.

Критерии stat поиска:
*Вывод статистики за указанный период без учета выходных. startDate - начальная дата, endDate - конечная дата.

Тестовые данные хранятся в директории testdata. Там есть дамп бд и несколько входных файлов для тестирования.

Инструкция по запуску:
1)Скопировать к себе репозиторий.

2)Перейти в файл dbprops.properties и настроить его под себя.

3.1)В случае использования IDE, создать Maven таск exec:java -Dexec.arguments=search,input.json,output.json, изменив необходимые аргументы (Следить за пробелами! Между аргументами их не должно быть, иначе парамет считается с пробелами.), далее добавить таски clean и compile перед запуском этого таска (промотать вниз, там будет окно для добавление тасков перед выполнением текущего).
3.2)В случае использования командной строки:
::Изменение кодировки на UTF-8, вместо лога будут нечитаемые абракадабры
chcp 65001
::Изменить входные параметры под себя. Не ставить пробелов перед или после аргументов!
mvn clean compile exec:java -Dexec.arguments=search,input.json,output.json

4)Для генерации jar файла необходимо выполнить:
mvn clean compile assembly:single
Jar файл создастся в директории target. Чтобы его запустить, необходимо выполнить команду:
java -jar dbanalyser-1.0.0.jar stat input.json output.json

Перед этим также стоит переключить кодировку на UTF-8^:
chcp 65001

Можно использовать различные субд для поиска информации, для этого необходимо добавить в файл pom.xml необходимую зависимость и в конфигурационном файле поменять url.
