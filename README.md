# DatabaseAnalyser

Кодировка: UTF-8 </br>
Формат файлов: JSON </br>
Конфигурационный файл бд: dbprops.properties </br>
Используемая по стандарту субд: postgreSQL </br>
Приложения для получения и ввыода данных из бд по входному json файлу. Результат записывается в выходной json файл.

Критерии поиска берутся из файла input.json </br>
Режим работы задаётся в аргументах командной строки. </br>
Текущие режимы: </br>
*search - поиск и выдача имен и фамилий пользователей по определенным критериям. </br>
*stat - вывод статистики за определенный период без учета выходных.

Критерии search поиска: </br>
*Поиск всех пользователей по фамилии. </br>
*Поиск покупателей, купивших товар productName не менее minTimes раз. </br>
*Поиск покупателей, у которых общая стоимость всех покупок попадает в указанный интервал minExpenses - maxExpenses </br>
*Поиск покупателей, купивших меньше всего товаров. Вовзвращается не более badCustomers покупателей.

Критерии stat поиска: </br>
*Вывод статистики за указанный период без учета выходных. startDate - начальная дата, endDate - конечная дата. </br>

Тестовые данные хранятся в директории testdata. Там есть дамп бд и несколько входных файлов для тестирования.

Инструкция по запуску: </br>
1)Скопировать к себе репозиторий.

2)Перейти в файл dbprops.properties и настроить его под себя.

3.1)В случае использования IDE, создать Maven таск exec:java -Dexec.arguments=search,input.json,output.json, изменив необходимые аргументы (Следить за пробелами! Между аргументами их не должно быть, иначе парамет считается с пробелами.), далее добавить таски clean и compile перед запуском этого таска (промотать вниз, там будет окно для добавление тасков перед выполнением текущего). </br>

3.2)В случае использования командной строки: </br>
::Изменение кодировки на UTF-8, вместо лога будут нечитаемые абракадабры </br>
chcp 65001 </br>
::Изменить входные параметры под себя. Не ставить пробелов перед или после аргументов! </br>
mvn clean compile exec:java -Dexec.arguments=search,input.json,output.json

4)Для генерации jar файла необходимо выполнить: </br>
mvn clean compile assembly:single </br>
Jar файл создастся в директории target. Чтобы его запустить, необходимо выполнить команду: </br>
java -jar dbanalyser-1.0.0.jar stat input.json output.json

Перед этим также стоит переключить кодировку на UTF-8: </br>
chcp 65001

Можно использовать различные субд для поиска информации, для этого необходимо добавить в файл pom.xml необходимую зависимость и в конфигурационном файле поменять url.
